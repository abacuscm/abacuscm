BUGLIST
#######

This file contains a list of BUGS and or nice to haves (wishlist).

* username vs realname
	A user should have both a username and a real-name.  The username can be
	used to log in whilst the real-name can be used for display in standings
	or clarification requests.

	PRIORITY: low

* Java classname handling.
	Need a better heuristic.  Quite probably force the classname to equal
	the JavaCase of the problem code (shortname).

	PRIORITY: medium

* udpmessenger improvements.
	The main problem with udpmessenger is congestion control.  Listed are a
	couple of possibilities to help solve this:

	1.  A queued ticketing system where we only have x number of packets "on
		the wire" and then ack individual fragments.
	2.  Or we could create a "data avail" message and then have the recipient
		request the fragments it needs.  This would still need to be combined
		with some kind of throttling mechanism.  Possibly only allow a
		recipient to request x number of fragments per round?

	The congestion problem can especially be seen where we try to transmit
	large (4MB has been seen before) PeerMessages.

	In all the schemes transmission of fragments related to a specific
	PeerMessage should immediately be terminated once that Message has been
	acked by the receiving server.

	PRIORITY: high

* No problem names to contestants before contest start
	Problem names should not be available to contestants before the start
	of the contest.  This allows them to potentially deduce what a problem
	is about and potentially start coding on solutions before the contest
	actually starts.

	PRIORITY: medium
	
* C/C++ libraries per-problem.
	The configuration of compiling and run-time environment should be more
	flexible.  Linking against libmath is an advantage for some problems
	and having to code functions like exp() or ln() is truly hard.  And
	these in turn are required to efficiently implement sqrt() and the like.

	PRIORITY: medium

* Failure to link -lm with C
	The code is there for it, but some contestants got link errors for
	sqrt and ceil during ICPC 2006. Compiling as C++ fixed it.

	PRIORITY: low

* Sort order for standings
	Should be numeric and the leading 0 hack really should not be needed.

	PRIORITY: medium

* runlimit information to judges
	The runlimit output file should be made available to judges.

	PRIORITY: medium

* Client-side execution environment
	Somehow the execution environment should be made available to
	contestants and judges to allow for more thorough testing.  Contestants
	want this to double-check their submissions before final submission and
	judges just want this to confirm the results from the automated judging
	system.

	PRIORITY: medium

* Port to Qt4.
	To allow for Windows ...

	Or use GTK+, which has a decent list view with user sort functions,
	separation between model and view, per-cell attributes, nicer
	integration with autoconf...

	PRIORITY: low

* Request for clarification on submissions page
	Well, when a submission is selected a button to request a clarification
	with regard to that submission is probably a good idea.

	PRIORITY: very low

* Auto-reconnect
	It would be nice if the server could automatically attempt to reconnect.

	PRIORITY: low

* item-based refresh
	In the list boxes it would be very cool to only update single items as
	needed instead of flushing out the entire list and rebuilding it.

	PRIORITY: medium

* No response on marking
	Judges want the ability to add a response (their own comment) to a 
	judge response.

	PRIORITY: very low

* Reason for wrong answer
	Need to add a field indicating any additional reasons why the answer
	is wrong (for e.g. format error).

	PRIORITY: medium

* Team name should be displayed.
	On the 'submissions' tab judges should be able to see team-names after
	submissions has been properly marked.

	PRIORITY: low
	
* Select all problems for judge by default
	By default the filter for a judge should be all problems.  Not none.

	PRIORITY: low

* Notify judges when new clarifications arrive

	PRIORITY: low

* Change colour of tabs to reflect status
	It would be extremely cool to change the colour of tabs depending on
	it's status.  For example, if there is new information in a tab change
	it's colour to blue or something.  As soon as the user switch to that
	tab, change it back.

	PRIORITY: very low

* Colours in listbox's.
	Different lines could be made different colours to reflect the content
	they contain.  For example clarification requests that has not yet been
	answered could be made red, a similar colour scheme could be used for
	submissions and potentially for unread clarifications as well as (at a
	long shot) for standings.

	PRIORITY: very low

* Indication of processing of submissions by judges
	Some indication/warning of judges that has solutions open.  Not critical
	but would make live a lot easier.

	PRIORITY: medium

* Segfault if kill'ed too soon.
	If the server received SIGKILL at the wrong time (during startup) then
	things go really belly up.  Classified as low since this only happened once
	during valgrinding.  Needs to be fixed though.

	PRIORITY: low

* ModuleLoader leaks memory
	These are once-off leaks during load.  Not too worried about these,
	however, as with all things broken it should be fixed.

	PRIORITY: low

* Better balloon notifications
	GUI should not pop up multiple notifications (in general, in fact).
	Possibly also some DB state to indicate whether a balloon has been
	handed out.

	PRIORITY: low

* If --enable-client etc are passed to configure, abort if they are not
	possible.

	PRIORITY: low

* Prevent module loader for looking into LD_LIBRARY_PATH

	PRIORITY: low

* Guarantee calls to my_thread_end happen in the right place.
	Currently they're done in a TLS destructor, but destructors run in
	arbitrary order while this has to be done before MySQL's TLS is destroyed.
	Should have a registration system for a thread-local list of shutdown
	functions, and have all threads call them before quitting.

	PRIORITY: low

Known leaks:

(trunk-r395)
==32465== 232 bytes in 2 blocks are definitely lost in loss record 9 of 19
==32465==    at 0x40209CE: calloc (in /usr/lib/valgrind/x86-linux/vgpreload_memcheck.so)
==32465==    by 0x459B855: my_thread_init (in /usr/lib/mysql/libmysqlclient_r.so.15.0.0)
==32465==    by 0x4565D5F: MySQLFunctor() (dbmysql.C:1522)
==32465==    by 0x4056004: DbCon::getInstance() (dbcon.C:33)
==32465==    by 0x478E94C: PasswdMessage::process() const (act_passwd.C:150)
==32465==    by 0x805B7ED: message_handler(void*) (abacusd.C:292)
==32465==    by 0x4080293: start_thread (in /lib/libpthread-2.4.so)
==32465==    by 0x425AC9D: clone (in /lib/libc-2.4.so)

Initial thoughts was that this is an instance of MySQL leaking, however,
sizeof(MySQL) is 1256.  This is possibly a leak in the MySQL C API.
mysql_init() in MySQL::init() is balanced with a mysql_close() in
MySQL::~MySQL() so that should be fine.  This may or may not be fixed by the
added call to mysql_server_init();

Other valgrind reported problems:

Most of these seem bogus ... but somebody else might spot something I don't
(And the fact that valgrind tends to be right about these kinds of things):

==865== Conditional jump or move depends on uninitialised value(s)
==865==    at 0x480571B: MarkMessage::process() const (act_mark.C:123)
==865==    by 0x805B7ED: message_handler(void*) (abacusd.C:292)
==865==    by 0x4080293: start_thread (in /lib/libpthread-2.4.so)
==865==    by 0x425AC9D: clone (in /lib/libc-2.4.so)

==865== Conditional jump or move depends on uninitialised value(s)
==865==    at 0x405C4C4: ClientConnection::process_data() (clientconnection.C:85)
==865==    by 0x405C706: ClientConnection::process() (clientconnection.C:125)
==865==    by 0x805BA08: worker_thread(void*) (abacusd.C:335)
==865==    by 0x4080293: start_thread (in /lib/libpthread-2.4.so)
==865==    by 0x425AC9D: clone (in /lib/libc-2.4.so)

==865== Conditional jump or move depends on uninitialised value(s)
==865==    at 0x405C492: ClientConnection::process_data() (clientconnection.C:87)
==865==    by 0x405C706: ClientConnection::process() (clientconnection.C:125)
==865==    by 0x805BA08: worker_thread(void*) (abacusd.C:335)
==865==    by 0x4080293: start_thread (in /lib/libpthread-2.4.so)
==865==    by 0x425AC9D: clone (in /lib/libc-2.4.so)

==865== Conditional jump or move depends on uninitialised value(s)
==865==    at 0x405C3F6: ClientConnection::process_data() (clientconnection.C:92)
==865==    by 0x405C706: ClientConnection::process() (clientconnection.C:125)
==865==    by 0x805BA08: worker_thread(void*) (abacusd.C:335)
==865==    by 0x4080293: start_thread (in /lib/libpthread-2.4.so)
==865==    by 0x425AC9D: clone (in /lib/libc-2.4.so)

==865== Conditional jump or move depends on uninitialised value(s)
==865==    at 0x405C40B: ClientConnection::process_data() (clientconnection.C:94)
==865==    by 0x405C706: ClientConnection::process() (clientconnection.C:125)
==865==    by 0x805BA08: worker_thread(void*) (abacusd.C:335)
==865==    by 0x4080293: start_thread (in /lib/libpthread-2.4.so)
==865==    by 0x425AC9D: clone (in /lib/libc-2.4.so)

==865== Conditional jump or move depends on uninitialised value(s)
==865==    at 0x42CE4BF: MessageBlock::addBytes(char const*, int) (messageblock.C:73)
==865==    by 0x405C3EE: ClientConnection::process_data() (clientconnection.C:91)
==865==    by 0x405C706: ClientConnection::process() (clientconnection.C:125)
==865==    by 0x805BA08: worker_thread(void*) (abacusd.C:335)
==865==    by 0x4080293: start_thread (in /lib/libpthread-2.4.so)
==865==    by 0x425AC9D: clone (in /lib/libc-2.4.so)

==865== Conditional jump or move depends on uninitialised value(s)
==865==    at 0x42CE4E6: MessageBlock::addBytes(char const*, int) (messageblock.C:74)
==865==    by 0x405C3EE: ClientConnection::process_data() (clientconnection.C:91)
==865==    by 0x405C706: ClientConnection::process() (clientconnection.C:125)
==865==    by 0x805BA08: worker_thread(void*) (abacusd.C:335)
==865==    by 0x4080293: start_thread (in /lib/libpthread-2.4.so)
==865==    by 0x425AC9D: clone (in /lib/libc-2.4.so)

==865== Conditional jump or move depends on uninitialised value(s)
==865==    at 0x42CE4FF: MessageBlock::addBytes(char const*, int) (messageblock.C:76)
==865==    by 0x405C3EE: ClientConnection::process_data() (clientconnection.C:91)
==865==    by 0x405C706: ClientConnection::process() (clientconnection.C:125)
==865==    by 0x805BA08: worker_thread(void*) (abacusd.C:335)
==865==    by 0x4080293: start_thread (in /lib/libpthread-2.4.so)
==865==    by 0x425AC9D: clone (in /lib/libc-2.4.so)

==865== Conditional jump or move depends on uninitialised value(s)
==865==    at 0x42CE490: MessageBlock::addBytes(char const*, int) (messageblock.C:71)
==865==    by 0x405C3EE: ClientConnection::process_data() (clientconnection.C:91)
==865==    by 0x405C706: ClientConnection::process() (clientconnection.C:125)
==865==    by 0x805BA08: worker_thread(void*) (abacusd.C:335)
==865==    by 0x4080293: start_thread (in /lib/libpthread-2.4.so)
==865==    by 0x425AC9D: clone (in /lib/libc-2.4.so)

==865== Use of uninitialised value of size 4
==865==    at 0x42CE4E6: MessageBlock::addBytes(char const*, int) (messageblock.C:74)
==865==    by 0x405C3EE: ClientConnection::process_data() (clientconnection.C:91)
==865==    by 0x405C706: ClientConnection::process() (clientconnection.C:125)
==865==    by 0x805BA08: worker_thread(void*) (abacusd.C:335)
==865==    by 0x4080293: start_thread (in /lib/libpthread-2.4.so)
==865==    by 0x425AC9D: clone (in /lib/libc-2.4.so)

